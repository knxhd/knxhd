(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{431:function(t,s,a){t.exports=a.p+"assets/img/dockerfile.ac91912a.png"},481:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"dockerfile介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile介绍"}},[t._v("#")]),t._v(" DockerFile介绍")]),t._v(" "),s("blockquote",[s("p",[t._v("DockerFile就是用来构建docker镜像的构建文件")])]),t._v(" "),s("ol",[s("li",[t._v("编写DockerFile，"),s("code",[t._v("vim DockerFile")])])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("from mysql:5.7\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 挂载位置，可为空，挂载目录1和2，可以自定义，在容器内也会添加相应的目录，此方式为匿名挂载方式")]),t._v("\nvolumn "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'挂载的目录1'")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'挂载的目录2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# echo为linux语法，表示在生成后，打印日志")]),t._v("\nCMD "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"--------end------------"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 生成后，进入目录中")]),t._v("\nCMD /bin/bash\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("通过docker build构建")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" build "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" DockerFile文件位置 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" 镜像名:tag名称 镜像位置\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[s("p",[t._v("通过"),s("code",[t._v("docker run")]),t._v("运行镜像")])]),t._v(" "),s("li",[s("p",[t._v("通过"),s("code",[t._v("docker push")]),t._v("发布镜像，可以发布到私有云或公有云。命令为：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" push 作者名/镜像名称:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])])]),t._v(" "),s("h3",{attrs:{id:"基本命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基本命令"}},[t._v("#")]),t._v(" 基本命令")]),t._v(" "),s("img",{attrs:{src:a(431)}}),t._v(" "),s("h2",{attrs:{id:"dockerfile构建过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile构建过程"}},[t._v("#")]),t._v(" DockerFile构建过程")]),t._v(" "),s("h3",{attrs:{id:"基础知识"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基础知识"}},[t._v("#")]),t._v(" 基础知识")]),t._v(" "),s("blockquote",[s("ol",[s("li",[t._v("每个保留关键字(指令) 采用大写字母")]),t._v(" "),s("li",[t._v("执行采用从上到下顺序执行")]),t._v(" "),s("li",[t._v("使用"),s("code",[t._v("#")]),t._v("表示注释")]),t._v(" "),s("li",[t._v("每个指令都会创建一个新的镜像层并提交")]),t._v(" "),s("li",[t._v("dockerFile是面向开发的，发布项目就需要编写一个dockerfile文件")])])]),t._v(" "),s("h2",{attrs:{id:"dockerfile指令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile指令"}},[t._v("#")]),t._v(" DockerFile指令")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("FROM       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#基础镜像\t")]),t._v("\nMAINTAINER "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 镜像维护者，即谁写的镜像")]),t._v("\nRUN        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 镜像构建时，需要执行的命令")]),t._v("\nADD        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 步骤，添加内容，例如：添加jar包等")]),t._v("\nCOPY.      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将文件拷贝到镜像中")]),t._v("\nWORKDIR    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 镜像的工作目录")]),t._v("\nVOLUME\t\t "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 挂载的目录")]),t._v("\nEXPOST\t\t "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 暴露的端口")]),t._v("\nCMD\t\t\t\t "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定容器启动时，要执行的命令，只有最后一个会会生效，可被替代")]),t._v("\nENTRYPOINT "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定容器启动时，要执行的命令，可以追加命令")]),t._v("\nENV\t       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 构建镜像时，设置环境变量")]),t._v("\n")])])]),s("h3",{attrs:{id:"add和copy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#add和copy"}},[t._v("#")]),t._v(" ADD和COPY")]),t._v(" "),s("blockquote",[s("ul",[s("li",[t._v("ADD 是将文件或文件夹添加到镜像中；COPY是将文件或文件夹复制到容器中")])])]),t._v(" "),s("h3",{attrs:{id:"cmd和entrypoint测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cmd和entrypoint测试"}},[t._v("#")]),t._v(" CMD和ENTRYPOINT测试")]),t._v(" "),s("blockquote",[s("ul",[s("li",[t._v("CMD命令：指定容器启动时，要执行的命令，只有最后一个会会生效，可被替代")]),t._v(" "),s("li",[t._v("ENTRYPOINT命令：指定容器启动时，要执行的命令，可以追加命令")])])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 基础镜像")]),t._v("\nFROM centos\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 维护者信息")]),t._v("\nMAINTAINER tianluhua"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("tianlh0915@163.com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 添加环境变量")]),t._v("\nENV MYOPATHY /usr/local\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置工作目录")]),t._v("\nWORKDIR "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MYOPATHY")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在启动后，执行命令 ls -a")]),t._v("\nCMD "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ls, -a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("ol",[s("li",[t._v("构建和运行容器")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@node01 centos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker build -f dockerfile.cmd -t centos-cmd:1.0 .")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("+"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Building "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".0s "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("/6"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" FINISHED                                                                                                                   docker:default\n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("internal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" load build definition from dockerfile.cmd                                                                                                     "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".0s\n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" transferring dockerfile: 285B                                                                                                                         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".0s\n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("internal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" load metadata "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" docker.io/library/centos:latest                                                                                             "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".0s\n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("internal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" load .dockerignore                                                                                                                            "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".0s\n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" transferring context: 2B                                                                                                                              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".0s\n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" FROM docker.io/library/centos:latest                                                                                                               "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".0s\n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" CACHED "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("/2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" WORKDIR /usr/local                                                                                                                          "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".0s\n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" exporting to image                                                                                                                                       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".0s\n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" exporting layers                                                                                                                                      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".0s\n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" writing image sha256:a7775a3de0aebc3140add37c476ef0f6bbb373a834fb9a7a82067f92e3f246f6                                                                 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".0s\n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" naming to docker.io/library/centos-cmd:1.0                                                                                                            "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".0s\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@node01 centos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker images")]),t._v("\nREPOSITORY   TAG       IMAGE ID       CREATED          SIZE\nmycentos     "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v("       89baefc697d9   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(" minutes ago   312MB\ncentos-cmd   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v("       a7775a3de0ae   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("45")]),t._v(" minutes ago   231MB\ncentos       latest    5d0da3dc9764   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" years ago      231MB\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@node01 centos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker run -it a7775a3de0ae")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("  bin  etc  games  include  lib  lib64  libexec  sbin  share  src\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@node01 centos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker run -it a7775a3de0ae -l")]),t._v("\ndocker: Error response from daemon: failed to create task "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: exec: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-l"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" executable "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" not found "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" unknown.\n")])])]),s("blockquote",[s("ul",[s("li",[t._v("运行时，添加来参数 "),s("code",[t._v("-l")]),t._v("，由于CMD执行时，最后的指令会做替换，因此，执行时，执行来-l，而不是ls -al，导致出现错误，此时如果改成ENTRYPOINT，则-l会追加到CMD后，即ls -al")])])]),t._v(" "),s("h2",{attrs:{id:"dockerfile实战"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile实战"}},[t._v("#")]),t._v(" DockerFile实战")]),t._v(" "),s("h3",{attrs:{id:"实战测试centos"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实战测试centos"}},[t._v("#")]),t._v(" 实战测试centos")]),t._v(" "),s("blockquote",[s("ul",[s("li",[t._v("以centos为例")])])]),t._v(" "),s("ol",[s("li",[t._v("新建dockerfile文件")])]),t._v(" "),s("blockquote",[s("ul",[s("li",[t._v("官方 centos 没有vim和nettools，即无法使用vim、ifconfig命令")]),t._v(" "),s("li",[t._v("在dockerfile中添加对应的依赖")])])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 基础镜像")]),t._v("\nFROM centos\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 维护者信息")]),t._v("\nMAINTAINER tianluhua"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("tianlh0915@163.com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 添加环境变量")]),t._v("\nENV MYOPATHY /usr/local\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置工作目录")]),t._v("\nWORKDIR "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MYOPATHY")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 配置yum源(可选，需要自己查看源是否可用，这里是centos8不可用才进行的更新)")]),t._v("\nRUN "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /etc/yum.repos.d/\nRUN "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"s/mirrorlist=/#mirrorlist=/g"')]),t._v(" /etc/yum.repos.d/CentOS-Linux-*.repo\nRUN "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"s|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g"')]),t._v(" /etc/yum.repos.d/CentOS-Linux-*.repo\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 更新vim")]),t._v("\nRUN yum "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-y")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 更新网络工具")]),t._v("\nRUN yum "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-y")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" net-tools\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 暴露端口")]),t._v("\nEXPOSE "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\nCMD "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MYOPATHY")]),t._v("\nCMD "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'------------end---------'")]),t._v("\n\nCMD /bin/bash\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("构建镜像")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" build "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" dockerfile "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" mycentos:1.0 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n")])])]),s("h3",{attrs:{id:"实战centos中部署springboot项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实战centos中部署springboot项目"}},[t._v("#")]),t._v(" 实战centos中部署springboot项目")]),t._v(" "),s("ol",[s("li",[t._v("准备工作：")])]),t._v(" "),s("blockquote",[s("ol",[s("li",[t._v("jdk8压缩包，在centos中配置jdk环境")]),t._v(" "),s("li",[t._v("jar包，soringboot项目包，项目可见：https://gitee.com/knxhd/spring-web.git，branch: demo")])])]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("编写Dockerfile文件")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 基础镜像")]),t._v("\nFROM centos\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 维护者信息")]),t._v("\nMAINTAINER tianluhua"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("tianlh0915@163.com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 添加环境变量")]),t._v("\nENV MYOPATHY /usr/local/\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置工作目录，此时目录中就是此目录")]),t._v("\nWORKDIR "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MYOPATHY")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 配置yum源(可选，需要自己查看源是否可用，这里是centos8不可用才进行的更新)")]),t._v("\nRUN "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /etc/yum.repos.d/\nRUN "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"s/mirrorlist=/#mirrorlist=/g"')]),t._v(" /etc/yum.repos.d/CentOS-Linux-*.repo\nRUN "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"s|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g"')]),t._v(" /etc/yum.repos.d/CentOS-Linux-*.repo\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 更新vim")]),t._v("\nRUN yum "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-y")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 更新网络工具")]),t._v("\nRUN yum "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-y")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" net-tools\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 新增目录，存储安装包")]),t._v("\nRUN "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" apps\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将jdk添加到镜像中")]),t._v("\nADD jdk-8u152-linux-x64.tar.gz /usr/local/apps/\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 解压文件并配置环境变量，这里需要注意的是，ADD命令会自动完成解压命令")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# RUN cd /usr/local/apps")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# RUN tar -zxvf ./jdk-8u152-linux-x64.tar.gz")]),t._v("\nENV JAVA_HOME /usr/local/apps/jdk1.8.0_152\nENV CLASSPATH "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$JAVA_HOME")]),t._v("/lib/dt.jar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$JAVA_HOME")]),t._v("/lib/tools.jar\nENV "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$JAVA_HOME")]),t._v("/bin\n\nEXPOSE "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8081")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将jar拷贝到容器中")]),t._v("\nCOPY java-demo-1.0-SNAPSHOT.jar /usr/local/\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动容器后执行的操作")]),t._v("\nENTRYPOINT "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"java"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-jar"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"java-demo-1.0-SNAPSHOT.jar"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# CMD nohup java -jar java-demo-1.0-SNAPSHOT.jar >> demo.log 2>&1 &")]),t._v("\n")])])]),s("blockquote",[s("ul",[s("li",[t._v("这里需要注意的是，运行springboot的包时，不需要采用后台运行的方式，否则无法根据logback进行输出。只需要使用"),s("code",[t._v("java -jar")]),t._v("来运行即可，而在启动容器时，采用后台运行。")]),t._v(" "),s("li",[t._v("尽量采用"),s("code",[t._v("ENTRYPOINT")]),t._v("来运行，采用"),s("code",[t._v("CMD")]),t._v("，如果在运行时，采用了"),s("code",[t._v("/bin/bash")]),t._v("，则会由于 后者覆盖"),s("code",[t._v("CMD")]),t._v("的指令，导致执行失效。")]),t._v(" "),s("li",[t._v("ADD命令如果是压缩包，则会自动解压压缩包，不需要再次解压。 ADD多用于需解压的文件；COPY更常用")])])]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("编译Dockerfile文件")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" build "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" Dockerfile "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" demo:1.0 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[t._v("启动容器")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" demo "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8081")]),t._v(":8081 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-it")]),t._v(" demo:1.0 /bin/bash\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[t._v("进入容器中，查看日志：")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@node01 centos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker exec -it d048c35b4ab8 /bin/bash")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@d048c35b4ab8 local"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls")]),t._v("\napps  bin  etc  games  include  java-demo-1.0-SNAPSHOT.jar  lib  lib64  libexec  logs  sbin  share  src\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@d048c35b4ab8 local"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd logs/")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@d048c35b4ab8 logs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# tail -500f web_")]),t._v("\nweb_debug.log  web_error.log  web_info.log   web_warn.log   \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@d048c35b4ab8 logs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# tail -500f web_")]),t._v("\nweb_debug.log  web_error.log  web_info.log   web_warn.log   \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@d048c35b4ab8 logs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# tail -500f web_info.log ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2024")]),t._v("-02-07 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":54:14.384 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  com.knxhd.SpringDemoApplication - Starting SpringDemoApplication v1.0-SNAPSHOT using Java "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.8")]),t._v(".0_152 on d048c35b4ab8 with PID "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("/usr/local/java-demo-1.0-SNAPSHOT.jar started by root "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" /usr/local"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2024")]),t._v("-02-07 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":54:14.401 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  com.knxhd.SpringDemoApplication - The following profiles are active: dev\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2024")]),t._v("-02-07 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":54:17.616 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8081")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("http"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2024")]),t._v("-02-07 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":54:17.658 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http-nio-8081"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2024")]),t._v("-02-07 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":54:17.659 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  org.apache.catalina.core.StandardService - Starting "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Tomcat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2024")]),t._v("-02-07 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":54:17.659 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Apache Tomcat/9.0.50"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2024")]),t._v("-02-07 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":54:17.873 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  o.a.c.core.ContainerBase."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Tomcat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("localhost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" - Initializing Spring embedded WebApplicationContext\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2024")]),t._v("-02-07 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":54:17.873 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3317")]),t._v(" ms\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2024")]),t._v("-02-07 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":54:19.825 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http-nio-8081"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2024")]),t._v("-02-07 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":54:20.014 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8081")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("http"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" with context path "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2024")]),t._v("-02-07 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":54:20.035 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  com.knxhd.SpringDemoApplication - Started SpringDemoApplication "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7.613")]),t._v(" seconds "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("JVM running "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.71")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2024")]),t._v("-02-07 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":54:59.238 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("http-nio-8081-exec-1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  o.a.c.core.ContainerBase."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Tomcat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("localhost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" - Initializing Spring DispatcherServlet "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dispatcherServlet'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2024")]),t._v("-02-07 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":54:59.238 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("http-nio-8081-exec-1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dispatcherServlet'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2024")]),t._v("-02-07 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":54:59.241 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("http-nio-8081-exec-1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" ms\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2024")]),t._v("-02-07 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":54:59.311 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("http-nio-8081-exec-1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  com.knxhd.controller.DemoController - 测试日志输出: dev\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2024")]),t._v("-02-07 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":55:03.216 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("http-nio-8081-exec-2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  com.knxhd.controller.DemoController - 测试日志输出: dev\n")])])]),s("h2",{attrs:{id:"发布镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#发布镜像"}},[t._v("#")]),t._v(" 发布镜像")]),t._v(" "),s("blockquote",[s("ul",[s("li",[t._v("以阿里云镜像仓库为例：https://cr.console.aliyun.com/cn-hangzhou/instance/repositories")]),t._v(" "),s("li",[t._v("新建命名空间和镜像仓库")])])]),t._v(" "),s("ol",[s("li",[t._v("登录阿里云账号")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" login "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("tianluhua0915 registry.cn-hangzhou.aliyuncs.com\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("将镜像推送到远程")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 镜像打标签版本")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" tag "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ImageId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" registry.cn-hangzhou.aliyuncs.com/knxhd/java-demo:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("镜像版本号"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将镜像上传到远程")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" push registry.cn-hangzhou.aliyuncs.com/knxhd/java-demo:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("镜像版本号"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);