(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{467:function(t,a,s){"use strict";s.r(a);var e=s(2),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"search接口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#search接口"}},[t._v("#")]),t._v(" _search接口")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("请求方式：POST")])]),t._v(" "),a("li",[a("p",[t._v("请求URL: "),a("code",[t._v("/index_name/_search")])])]),t._v(" "),a("li",[a("p",[t._v("基本格式")])])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"query"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"search_type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            \n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"范围查询-terms"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#范围查询-terms"}},[t._v("#")]),t._v(" 范围查询：terms")]),t._v(" "),a("ul",[a("li",[t._v("基本格式：")])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"query"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"terms"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"fieldName"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"value1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"value2"')]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[t._v("fieldName表示ES文档中的字段名称")])]),t._v(" "),a("h3",{attrs:{id:"模糊查询-match查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模糊查询-match查询"}},[t._v("#")]),t._v(" 模糊查询：match查询")]),t._v(" "),a("ul",[a("li",[t._v("基本格式")])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"query"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"match"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"字段名"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"字段值"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"通配符查询-wildcard查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通配符查询-wildcard查询"}},[t._v("#")]),t._v(" 通配符查询：wildcard查询")]),t._v(" "),a("h3",{attrs:{id:"must和must-not"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#must和must-not"}},[t._v("#")]),t._v(" must和must not")]),t._v(" "),a("blockquote",[a("ul",[a("li",[t._v("must可用于与运算，将多个查询条件放到一个里面")])])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('{\n  "query": {\n    "bool": {\n      "must": [\n        {\n          "match": {\n            "字段名": "字段值"\n          }\n        },\n        {\n          "terms": {\n            "字段名": ["字段值"]\n          }\n        }\n      ]\n    }\n  }\n}\n\n')])])]),a("h2",{attrs:{id:"settings接口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#settings接口"}},[t._v("#")]),t._v(" _settings接口")]),t._v(" "),a("blockquote",[a("ul",[a("li",[t._v("查询索引的状态")]),t._v(" "),a("li",[t._v("请求方式：GET")]),t._v(" "),a("li",[t._v("URL: /索引名称/_settings")])])]),t._v(" "),a("h3",{attrs:{id:"接口返回值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#接口返回值"}},[t._v("#")]),t._v(" 接口返回值")]),t._v(" "),a("blockquote",[a("ul",[a("li",[t._v("index_name:表示索引名称")]),t._v(" "),a("li",[t._v("read_only_allow_delete表示索引的状态，目前为只可读")])])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('{\n    "index_name": {\n        "settings": {\n            "index": {\n                "refresh_interval": "1s",\n                "number_of_shards": "5",\n                "blocks": {\n                    "read_only_allow_delete": "true"\n                },\n                "provided_name": "test_plan",\n                "creation_date": "1704181880341",\n                "store": {\n                    "type": "fs"\n                },\n                "number_of_replicas": "1",\n                "uuid": "9eFBywTgT4aRCDFKlRbwKw",\n                "version": {\n                    "created": "6020299"\n                }\n            }\n        }\n    }\n}\n')])])]),a("h4",{attrs:{id:"read-only-allow-delete"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#read-only-allow-delete"}},[t._v("#")]),t._v(" read_only_allow_delete")]),t._v(" "),a("ol",[a("li",[t._v("为true的原因")])]),t._v(" "),a("blockquote",[a("ul",[a("li",[t._v("内存不足")])]),t._v(" "),a("p",[t._v("JVMMemoryPressure 超过92%并持续30分钟时，ES触发保护机制，并且阻止写入操作，以防止集群达到红色状态，启用写保护后，写入操作将失败，并且抛出 ClusterBlockException ，无法创建新索引，并且抛出 IndexCreateBlockException ,当五分钟内恢复不到88%以下时，将禁用写保护。")])]),t._v(" "),a("blockquote",[a("ul",[a("li",[t._v("磁盘空间不足")])]),t._v(" "),a("p",[t._v("es的默认磁盘水位警戒线是85%，一旦磁盘使用率超过85%，es不会再为该节点分配分片，es还有一个磁盘水位警戒线是90%，超过后，将尝试将分片重定位到其他节点。")])]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("修改状态值为false")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XPUT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-H")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-Type: application/json"')]),t._v(" http://127.0.0.1:9200/索引名称/_settings "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{\"index.blocks.read_only_allow_delete\": null}'")]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);